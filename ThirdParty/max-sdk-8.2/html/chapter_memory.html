<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Max API: Memory Allocation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Max API
   &#160;<span id="projectnumber">8.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('chapter_memory.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Memory Allocation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Max API offers cross-platform calls memory management.</p>
<p>There are two types of calls, those for pointers and those for handles. Handles are pointers to pointers, and were used in the early Mac OS to permit memory to be relocated without changing a reference, and many Mac OS API calls used handle. There are a few legacy Max API calls that use handles as well, but in general, unless the OS or Max requires the use of a handle, you're probably better off using the simpler pointer.</p>
<p>Longtime Max object programmers may have used memory calls <a class="el" href="group__memory.html#gad4269b29be988878da2d8d5579696d60" title="Allocate small amounts of non-relocatable memory.">getbytes()</a> and <a class="el" href="group__memory.html#ga5520eadf3494221726cfaf3cbd35f8e9" title="Free memory allocated with getbytes().">freebytes()</a> in the past, but all memory calls now use same underlying OS mechanisms, so while <a class="el" href="group__memory.html#gad4269b29be988878da2d8d5579696d60" title="Allocate small amounts of non-relocatable memory.">getbytes()</a> and <a class="el" href="group__memory.html#ga5520eadf3494221726cfaf3cbd35f8e9" title="Free memory allocated with getbytes().">freebytes()</a> are still supported, they are restricted to 32K of memory or less due to the arguments they use, and we recommend the use of <a class="el" href="group__memory.html#ga24c6073f05e5c4a9bf980b7a4320fbf4" title="Allocate memory.">sysmem_newptr()</a> and <a class="el" href="group__memory.html#ga200c82639e547869db1f3887d17102d3" title="Free memory allocated with sysmem_newptr().">sysmem_freeptr()</a> instead.</p>
<p>Here are some examples of allocating and freeing pointers and handles.</p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> *ptr;</div>
<div class="line"><span class="keywordtype">char</span> **hand;</div>
<div class="line"> </div>
<div class="line">ptr = <a class="code" href="group__memory.html#ga24c6073f05e5c4a9bf980b7a4320fbf4">sysmem_newptr</a>(2000);</div>
<div class="line"><a class="code" href="group__console.html#gacf5ee98c48f04999675f58bc6470cdcc">post</a>(<span class="stringliteral">&quot;I have a pointer %lx and it is %ld bytes in size&quot;</span>,ptr, <a class="code" href="group__memory.html#gadbb10510c2bc5b6235c8939b77f3e0c0">sysmem_ptrsize</a>(ptr));</div>
<div class="line">ptr = <a class="code" href="group__memory.html#gaddd4b4a07a591470081c86bfefb825b6">sysmem_resizeptrclear</a>(ptr, 3000);</div>
<div class="line"><a class="code" href="group__console.html#gacf5ee98c48f04999675f58bc6470cdcc">post</a>(<span class="stringliteral">&quot;Now I have a pointer %lx and it is %ld bytes in size&quot;</span>,ptr, <a class="code" href="group__memory.html#gadbb10510c2bc5b6235c8939b77f3e0c0">sysmem_ptrsize</a>(ptr));</div>
<div class="line"><a class="code" href="group__memory.html#ga200c82639e547869db1f3887d17102d3">sysmem_freeptr</a>(ptr);</div>
<div class="line"> </div>
<div class="line">hand = <a class="code" href="group__memory.html#ga2afc324580bca92459ec78a9f9e5de24">sysmem_newhandle</a>(2000);</div>
<div class="line"><a class="code" href="group__console.html#gacf5ee98c48f04999675f58bc6470cdcc">post</a>(<span class="stringliteral">&quot;I have a handle %lx and it is %ld bytes in size&quot;</span>,hand, <a class="code" href="group__memory.html#ga54929317f2b3edd4a9e163ec9b2f791a">sysmem_handlesize</a>(hand));</div>
<div class="line"><a class="code" href="group__memory.html#ga3ca007063b7a720936db031bf57a40ec">sysmem_resizehandle</a>(hand, 3000);</div>
<div class="line"><a class="code" href="group__console.html#gacf5ee98c48f04999675f58bc6470cdcc">post</a>(<span class="stringliteral">&quot;Now the handle %lx is %ld bytes in size&quot;</span>,hand, <a class="code" href="group__memory.html#gadbb10510c2bc5b6235c8939b77f3e0c0">sysmem_ptrsize</a>(hand));</div>
<div class="line"><a class="code" href="group__memory.html#ga5815994f7d02b77c24f8c684df9acd83">sysmem_freehandle</a>(hand);</div>
<div class="ttc" id="agroup__console_html_gacf5ee98c48f04999675f58bc6470cdcc"><div class="ttname"><a href="group__console.html#gacf5ee98c48f04999675f58bc6470cdcc">post</a></div><div class="ttdeci">BEGIN_USING_C_LINKAGE void post(C74_CONST char *fmt,...)</div><div class="ttdoc">Print text to the Max window.</div></div>
<div class="ttc" id="agroup__memory_html_ga200c82639e547869db1f3887d17102d3"><div class="ttname"><a href="group__memory.html#ga200c82639e547869db1f3887d17102d3">sysmem_freeptr</a></div><div class="ttdeci">void sysmem_freeptr(void *ptr)</div><div class="ttdoc">Free memory allocated with sysmem_newptr().</div></div>
<div class="ttc" id="agroup__memory_html_ga24c6073f05e5c4a9bf980b7a4320fbf4"><div class="ttname"><a href="group__memory.html#ga24c6073f05e5c4a9bf980b7a4320fbf4">sysmem_newptr</a></div><div class="ttdeci">BEGIN_USING_C_LINKAGE t_ptr sysmem_newptr(t_ptr_size size)</div><div class="ttdoc">Allocate memory.</div></div>
<div class="ttc" id="agroup__memory_html_ga2afc324580bca92459ec78a9f9e5de24"><div class="ttname"><a href="group__memory.html#ga2afc324580bca92459ec78a9f9e5de24">sysmem_newhandle</a></div><div class="ttdeci">t_handle sysmem_newhandle(t_ptr_size size)</div><div class="ttdoc">Allocate a handle (a pointer to a pointer).</div></div>
<div class="ttc" id="agroup__memory_html_ga3ca007063b7a720936db031bf57a40ec"><div class="ttname"><a href="group__memory.html#ga3ca007063b7a720936db031bf57a40ec">sysmem_resizehandle</a></div><div class="ttdeci">t_max_err sysmem_resizehandle(t_handle handle, t_ptr_size newsize)</div><div class="ttdoc">Resize an existing handle.</div></div>
<div class="ttc" id="agroup__memory_html_ga54929317f2b3edd4a9e163ec9b2f791a"><div class="ttname"><a href="group__memory.html#ga54929317f2b3edd4a9e163ec9b2f791a">sysmem_handlesize</a></div><div class="ttdeci">t_ptr_size sysmem_handlesize(t_handle handle)</div><div class="ttdoc">Find the size of a handle.</div></div>
<div class="ttc" id="agroup__memory_html_ga5815994f7d02b77c24f8c684df9acd83"><div class="ttname"><a href="group__memory.html#ga5815994f7d02b77c24f8c684df9acd83">sysmem_freehandle</a></div><div class="ttdeci">void sysmem_freehandle(t_handle handle)</div><div class="ttdoc">Free memory allocated with sysmem_newhandle().</div></div>
<div class="ttc" id="agroup__memory_html_gadbb10510c2bc5b6235c8939b77f3e0c0"><div class="ttname"><a href="group__memory.html#gadbb10510c2bc5b6235c8939b77f3e0c0">sysmem_ptrsize</a></div><div class="ttdeci">t_ptr_size sysmem_ptrsize(void *ptr)</div><div class="ttdoc">Find the size of a pointer.</div></div>
<div class="ttc" id="agroup__memory_html_gaddd4b4a07a591470081c86bfefb825b6"><div class="ttname"><a href="group__memory.html#gaddd4b4a07a591470081c86bfefb825b6">sysmem_resizeptrclear</a></div><div class="ttdeci">t_ptr sysmem_resizeptrclear(void *ptr, t_ptr_size newsize)</div><div class="ttdoc">Resize an existing pointer and clear the newly allocated memory, if any.</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
